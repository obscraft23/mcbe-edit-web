<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>{% block title %}{% endblock %}</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Source code generated using layoutit.com">
  <meta name="author" content="LayoutIt!">
  

</head>
<body>

{% block content %}
    <h1>world edit</h1>
    <form method="post">
        {% csrf_token %}

        {{ form1.media }}
        
        {{ form1.worldid }}
        {{ form1.choice_dim }}
        {{ form1.choice_type }}
        
        <div class="form-group">
          <select id="id_nbt" class="form-control" name="nbt">
            <option value="dummy">--select NBT--</option>
          </select>
        </div>
        <button type="submit" name="submit-form1">Submit</button>

        {{ form2.media }}
        {{ form2.jsondata }}
        
    </form>
  
    <script src="https://code.jquery.com/jquery-3.5.0.js" integrity="sha256-r/AaFHrszJtwpe+tHyNi/XCfMxYpbsRg2Uqn0x3s2zc=" crossorigin="anonymous"></script>

    <script>
        $("#id_type").change(function () {
            var typeid = $(this).val();
            var worldid = $("#id_worldid").val();
            var choice_dim = $("#id_choice_dim").val()
            $.ajax({
                type: "POST",
                url: "{% url 'getnbtinfo' %}",
                data: {
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                    'worldid': worldid,
                    'type': typeid,
                    'choice_dim': choice_dim
                },
                success: function (data) {
                    console.log(data.nbts);
                    if (data.type == "0") {
                      $("#id_nbt").html('<option value="dummy">--select NBT--</option>');
                    }
                    else {
                      let html_data = '<option value="dummy">--select NBT--</option>';
                      data.nbts.forEach(function (data) {
                          console.log(data)
                          html_data += `<option value="${data[0]}">${data[1]}</option>`
                      });
                      $("#id_nbt").html(html_data);
                    }
                }
            });
        });
        $("#id_choice_dim").change(function () {
            var typeid = $("#id_type").val();
            var worldid = $("#id_worldid").val();
            var choice_dim = $("#id_choice_dim").val()
            $.ajax({
                type: "POST",
                url: "{% url 'getnbtinfo' %}",
                data: {
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                    'worldid': worldid,
                    'type': typeid,
                    'choice_dim': choice_dim
                },
                success: function (data) {
                    console.log(data.nbts);
                    if (data.type == "0") {$("#id_nbt").html('<option value="dummy">--select NBT--</option>');}
                    else {
                      let html_data = '<option value="dummy">--select NBT--</option>';
                      data.nbts.forEach(function (data) {
                          console.log(data)
                          html_data += `<option value="${data[0]}">${data[1]}</option>`
                      });
                      $("#id_nbt").html(html_data);
                    }
                }
            });
        });
    </script>
{% endblock %}

</body>
</html>